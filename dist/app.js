(()=>{function p(c,i=window,o={}){try{i.dispatchEvent(new CustomEvent(c,{bubbles:!0,cancelable:!0,detail:o}))}catch{}try{window.dispatchEvent(new CustomEvent(c,{detail:o}))}catch{}}console.log("[ACCORDION] module loaded");function x(c=".accordeon"){let i=document.querySelector(c);if(!i){console.log("[ACCORDION] root not found");return}let o=e=>e.classList.contains("accordeon-item--level1"),s=e=>e.classList.contains("accordeon-item--level2"),a=e=>e==null?void 0:e.querySelector(":scope > .accordeon__list"),u=e=>o(e)?i:e.closest(".accordeon__list");i.querySelectorAll(".accordeon__trigger").forEach((e,t)=>{e.setAttribute("role","button"),e.setAttribute("tabindex","0");let n=e.closest(".accordeon-item--level1, .accordeon-item--level2"),r=a(n);if(r){let l=r.id||`acc-panel-${t}`;r.id=l,e.setAttribute("aria-controls",l),e.setAttribute("aria-expanded","false")}});function d(e){e.style.maxHeight=e.scrollHeight+"px",e.dataset.state="opening";let t=n=>{n.propertyName==="max-height"&&(e.removeEventListener("transitionend",t),e.dataset.state==="opening"&&(e.style.maxHeight="none",e.dataset.state="open"))};e.addEventListener("transitionend",t)}function f(e){let t=e.style.maxHeight==="none"?e.scrollHeight:parseFloat(e.style.maxHeight||0);e.style.maxHeight=(t||e.scrollHeight)+"px",e.offsetHeight,e.style.maxHeight="0px",e.dataset.state="closing";let n=r=>{r.propertyName==="max-height"&&(e.removeEventListener("transitionend",n),e.dataset.state="collapsed")};e.addEventListener("transitionend",n)}function g(e){let t=u(e);if(!t)return;let n=o(e)?"accordeon-item--level1":"accordeon-item--level2";Array.from(t.children).forEach(r=>{var h;if(r===e||!((h=r.classList)!=null&&h.contains(n)))return;let l=a(r);if(l&&(l.dataset.state==="open"||l.dataset.state==="opening")){f(l);let m=r.querySelector(".accordeon__trigger");m==null||m.setAttribute("aria-expanded","false"),p(o(e)?"ACC_L1_CLOSE":"ACC_L2_CLOSE",r,{source:"sibling"})}})}function y(){i.querySelectorAll(".accordeon-item--level2 .accordeon__list").forEach(e=>{var t;if(e.dataset.state==="open"||e.dataset.state==="opening"){f(e);let n=e.closest(".accordeon-item--level2");(t=n==null?void 0:n.querySelector(".accordeon__trigger"))==null||t.setAttribute("aria-expanded","false"),p("ACC_L2_CLOSE",n,{source:"reset-all"})}})}function b(e){let t=a(e);if(!t)return;let n=e.querySelector(".accordeon__trigger"),r=!(t.dataset.state==="open"||t.dataset.state==="opening");g(e),r&&o(e)&&y(),r?(d(t),n==null||n.setAttribute("aria-expanded","true"),p(o(e)?"ACC_L1_OPEN":"ACC_L2_OPEN",e,{opening:!0})):(f(t),n==null||n.setAttribute("aria-expanded","false"),o(e)&&y(),p(o(e)?"ACC_L1_CLOSE":"ACC_L2_CLOSE",e,{opening:!1}))}document.body.classList.add("js-prep"),i.querySelectorAll(".accordeon__list").forEach(e=>{e.style.maxHeight="0px",e.dataset.state="collapsed"}),requestAnimationFrame(()=>document.body.classList.remove("js-prep")),i.addEventListener("click",e=>{let t=e.target.closest(".accordeon__trigger");if(!t||!i.contains(t))return;e.preventDefault();let n=t.closest(".accordeon-item--level1, .accordeon-item--level2");n&&b(n)}),i.addEventListener("keydown",e=>{let t=e.target.closest(".accordeon__trigger");if(!t||!i.contains(t)||e.key!=="Enter"&&e.key!==" ")return;e.preventDefault();let n=t.closest(".accordeon-item--level1, .accordeon-item--level2");n&&b(n)});let A=new ResizeObserver(e=>{e.forEach(({target:t})=>{t.dataset.state==="open"?t.style.maxHeight="none":t.dataset.state==="opening"&&(t.style.maxHeight=t.scrollHeight+"px")})});i.querySelectorAll(".accordeon__list").forEach(e=>A.observe(e))}var _=0,L=0,w="";function S(){if(_++)return;let c=document.documentElement;w=c.style.scrollBehavior,c.style.scrollBehavior="auto",L=window.scrollY||c.scrollTop||0,Object.assign(document.body.style,{position:"fixed",top:`-${L}px`,left:"0",right:"0",width:"100%",overflow:"hidden",overscrollBehavior:"none"});try{document.body.classList.add("modal-open")}catch{}}function v({delayMs:c=0}={}){let i=()=>{if(--_>0)return;let o=document.documentElement;Object.assign(document.body.style,{position:"",top:"",left:"",right:"",width:"",overflow:"",overscrollBehavior:""});try{document.body.classList.remove("modal-open")}catch{}o.style.scrollBehavior=w||"",window.scrollTo(0,L)};c?setTimeout(i,c):i()}console.log("[VIMEO] module loaded");function k(c){var o;if(!c)return"";let i=String(c).trim();if(/^\d+$/.test(i))return i;try{let s=new URL(i,"https://example.com");if((s.hostname||"").includes("vimeo.com")){let u=s.pathname.split("/").filter(Boolean);return((o=(u[u.length-1]||"").match(/\d+/))==null?void 0:o[0])||""||""}}catch{}return""}function C(c,i,o={}){if(!c)return;let s=k(i);if(!s){c.innerHTML="";return}let a=new URLSearchParams({dnt:1,...o}).toString(),u=`https://player.vimeo.com/video/${s}?${a}`,d=document.createElement("iframe");d.src=u,d.allow="autoplay; fullscreen; picture-in-picture; encrypted-media; accelerometer; gyroscope; clipboard-write; web-share",d.setAttribute("frameborder","0"),d.style.width="100%",d.style.height="100%",c.innerHTML="",c.appendChild(d)}console.log("[LIGHTBOX] module loaded");function O({root:c="#project-lightbox",closeDelayMs:i=1e3}={}){let o=document.querySelector(c);if(!o){console.log("[LIGHTBOX] not found");return}o.setAttribute("role",o.getAttribute("role")||"dialog"),o.setAttribute("aria-modal",o.getAttribute("aria-modal")||"true"),o.setAttribute("aria-hidden",o.getAttribute("aria-hidden")||"true");let s=o.querySelector(".project-lightbox__inner"),a=o.querySelector(".video-area"),u=document.querySelectorAll(".slide"),d=matchMedia("(prefers-reduced-motion: reduce)").matches,f=!1,g=null;function y(t){Array.from(document.body.children).filter(r=>r!==o).forEach(r=>{try{"inert"in r&&(r.inert=!!t)}catch{}t?r.setAttribute("aria-hidden","true"):r.removeAttribute("aria-hidden")})}function b(t){if(t.key!=="Tab")return;let n=o.querySelectorAll(["a[href]","button","input","select","textarea",'[tabindex]:not([tabindex="-1"])'].join(",")),r=Array.from(n).filter(m=>!m.hasAttribute("disabled")&&!m.getAttribute("aria-hidden"));if(r.length===0){t.preventDefault(),(s||o).focus();return}let l=r[0],h=r[r.length-1];t.shiftKey&&document.activeElement===l?(t.preventDefault(),h.focus()):!t.shiftKey&&document.activeElement===h&&(t.preventDefault(),l.focus())}function A(t){var h,m,E;if(f)return;f=!0,g=document.activeElement instanceof HTMLElement?document.activeElement:null;let n=((h=t==null?void 0:t.dataset)==null?void 0:h.video)||"",r=((m=t==null?void 0:t.dataset)==null?void 0:m.title)||"",l=((E=t==null?void 0:t.dataset)==null?void 0:E.text)||"";a&&C(a,n,{autoplay:1,muted:1,controls:0,background:1,playsinline:1,dnt:1}),o.setAttribute("aria-hidden","false"),o.setAttribute("data-open","true"),y(!0),S(),o.setAttribute("tabindex","-1"),(s||o).focus(),p("LIGHTBOX_OPEN",o,{video:n,title:r,text:l})}function e(){f&&(p("LIGHTBOX_CLOSE",o),d?(v({delayMs:0}),p("LIGHTBOX_CLOSED_DONE",o)):v({delayMs:i}),o.setAttribute("aria-hidden","true"),o.removeAttribute("data-open"),y(!1),a&&(a.innerHTML=""),g&&document.body.contains(g)&&g.focus(),f=!1)}u.forEach(t=>t.addEventListener("click",()=>A(t))),o.addEventListener("click",t=>{(s&&!t.target.closest(".project-lightbox__inner")||!s&&t.target===o)&&e()}),document.addEventListener("keydown",t=>{o.getAttribute("data-open")==="true"&&(t.key==="Escape"&&e(),t.key==="Tab"&&b(t))}),o.addEventListener("LIGHTBOX_CLOSED_DONE",()=>v())}function q(){let c=["accelerometer","autoplay","clipboard-write","encrypted-media","gyroscope","picture-in-picture","web-share"],i=['iframe[src*="youtube.com"]','iframe[src*="youtu.be"]','iframe[src*="youtube-nocookie.com"]'].join(",");document.querySelectorAll(i).forEach(o=>{let s=(o.getAttribute("allow")||"").split(";").map(u=>u.trim()).filter(Boolean),a=Array.from(new Set([...s,...c])).join("; ");o.setAttribute("allow",a)})}function H(c={}){let i=c.lightboxRoot||"#project-lightbox";x(".accordeon"),O({root:i,closeDelayMs:1e3})}window.App||(window.App={});window.App.init=H;document.addEventListener("DOMContentLoaded",()=>{try{q(),H()}catch(c){console.error("[App] init error",c)}});})();
