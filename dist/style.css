/**
 * ==================================================
 *  McCann Website — Styles
 *  Merged CSS for Webflow integration
 * ==================================================
 */

/* Global hardening */
html, body { 
  height: 100%;
  margin: 0;
  padding: 0;
  /* CRITICAL: Ensure cursor can move across entire viewport */
  overflow-x: visible !important;
  overflow-y: auto;
}
html { 
  overscroll-behavior: none;                      /* kill rubber-banding chain */
}
body {
  margin: 0;
  padding: 0;
  overscroll-behavior-y: none;
  -webkit-text-size-adjust: 100%;
  -webkit-tap-highlight-color: rgba(0,0,0,0);
  /* CRITICAL: Prevent body from clipping cursor */
  overflow-x: visible !important;
  overflow-y: auto;
}

/* Disable text selection globally */
* {
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  -webkit-touch-callout: none; /* Disable iOS callout */
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  orphans: 2; /* Minimum 2 lines at bottom of page/column */
  widows: 2;  /* Minimum 2 lines at top of page/column */
}

/* Allow selection for input fields and textareas */
input,
textarea,
[contenteditable="true"],
::selection {
  -webkit-user-select: text;
  -moz-user-select: text;
  -ms-user-select: text;
  user-select: text;
}

img, svg, video { -webkit-user-drag: none; }

/* Snap/Parallax stability */
.slide{ contain: layout paint; }

/* Lightbox baseline (starts closed) */
.lightbox {
  position: fixed !important; /* Keep position fixed always */
  inset: 0; 
  z-index: 9999;
  opacity: 0; 
  visibility: hidden; 
  pointer-events: none;
  /* Keep element in DOM so GSAP can animate, but hide with visibility/opacity */
}
.lightbox.is-open { 
  opacity: 1; 
  visibility: visible; 
  pointer-events: auto; 
}

/* CRITICAL: Ensure overlay doesn't block cursor when lightbox is closed */
/* This fixes cursor not following mouse on right side → overlay was intercepting events */
.lightbox:not(.is-open) .lightbox__overlay,
.lightbox:not(.is-open) [class*="lightbox_overlay"] {
  pointer-events: none !important;
}

/* Lock page when overlays are open */
body.modal-open { overflow: hidden; }
/* If a dedicated scroll wrapper existed, it would be locked here.
   Now slides are direct children of body, so the fixed-body lock is sufficient. */

/* Small BEM utilities we can reuse anywhere */
.u-visually-hidden { position:absolute !important; clip:rect(1px,1px,1px,1px); padding:0; border:0; height:1px; width:1px; overflow:hidden; }

/* Accordion base styles */
.acc-list {
  overflow: hidden;
  transition: max-height .28s cubic-bezier(.25,.8,.25,1);
  will-change: max-height;
}

/* Ensure items are visible by default */
.acc-item {
  opacity: 1;
  transform: none;
  transition: none; /* Let GSAP handle animations */
}

/* Ensure top-level rows are always visible (only items inside panels animate) */
.accordeon > .acc-item {
  opacity: 1 !important;
  visibility: visible !important;
}

/* Visual feedback for active triggers */
.acc-trigger.acc-trigger--active {
  font-weight: 600;
  background-color: rgba(0, 0, 0, 0.05);
}

/* Ensure GSAP can animate these */
.acc-animate-target {
  will-change: transform, opacity;
}

/* Debug: Highlight animated items (remove in production) */
.debug-mode .acc-animate-target {
  outline: 2px solid orange !important;
  background: rgba(255, 165, 0, 0.1) !important;
}

/* Custom Cursor - Functional styles only (design in Webflow) */

/* Ensure wrapper doesn't create positioning context */
.cursor-wrapper {
  position: static !important; /* Don't create containing block */
  overflow: visible !important; /* Don't clip cursor */
  pointer-events: none !important; /* Don't interfere with interactions */
  z-index: 0 !important; /* Reset any inherited z-index */
  /* CRITICAL: Ensure wrapper doesn't clip or constrain cursor */
  clip: none !important;
  clip-path: none !important;
}

.cursor {
  /* Position fixed to viewport → crucial for cursor to work across entire screen */
  /* IMPORTANT: Must be positioned relative to viewport, not wrapper */
  position: fixed !important;
  top: 0 !important;
  left: 0 !important;
  right: auto !important;
  bottom: auto !important;
  
  /* Position controlled by JS via CSS custom properties */
  transform: translate(calc(var(--cursor-x, 0px) - 50%), calc(var(--cursor-y, 0px) - 50%));
  pointer-events: none !important;
  will-change: transform, scale;
  
  /* Scale states - snappy organic transition */
  scale: 0.2; /* Small when no label */
  transition: scale 70ms cubic-bezier(0.34, 1.56, 0.64, 1), opacity 0.2s ease;
  
  /* Ensure cursor is above everything → higher than lightbox (9999) */
  z-index: 99999 !important;
  
  /* Ensure cursor can move beyond wrapper bounds */
  margin: 0 !important;
  padding: 0 !important;
  
  /* CRITICAL: Prevent any clipping or overflow constraints */
  overflow: visible !important;
  clip: none !important;
  clip-path: none !important;
  
  /* Ensure cursor can move across entire viewport */
  max-width: none !important;
  max-height: none !important;
}

.cursor.has-label {
  scale: 1; /* Full size when hovering actionable elements */
}

/* Label pop-up animation - constrained and solid */
.cursor__label {
  /* Default state: hidden and slightly scaled down */
  scale: 0.85;
  opacity: 0;
  transition: scale 90ms cubic-bezier(0.2, 0, 0.2, 1), 
              opacity 60ms ease-out;
  will-change: scale, opacity;
}

.cursor__label.is-visible {
  /* Visible state: full size with quick pop */
  scale: 1;
  opacity: 1;
  transition: scale 90ms cubic-bezier(0.2, 0, 0.2, 1), 
              opacity 80ms ease-in;
}

/* Hide custom cursor when user prefers reduced motion */
@media (prefers-reduced-motion: reduce) {
  .cursor {
    display: none !important;
  }
}
